<!doctype html>
<html lang="ko">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <title>사이버감사실 제보 페이지(초안)</title>
  <style>
    :root{--bg:#f5f7fb;--card:#ffffff;--accent:#0b6efd;--muted:#6b7280}
    body{font-family:Inter, "Noto Sans KR", system-ui, -apple-system, Arial; background:var(--bg); margin:0; color:#111}
    .container{max-width:900px;margin:48px auto;padding:24px}
    header{display:flex;align-items:center;gap:16px}
    .logo{width:60px;height:60px;border-radius:8px;background:linear-gradient(135deg,#0b6efd,#7cc1ff);display:flex;align-items:center;justify-content:center;color:#fff;font-weight:700}
    h1{margin:0;font-size:20px}
    p.lead{color:var(--muted);margin-top:8px}

    .card{background:var(--card);border-radius:12px;padding:20px;margin-top:20px;box-shadow:0 6px 18px rgba(10,20,40,0.06)}
    h2{margin:0 0 12px 0}
    ul{padding-left:20px}

    .btn{display:inline-block;padding:10px 16px;border-radius:8px;background:var(--accent);color:#fff;text-decoration:none;border:none;cursor:pointer}
    .btn.secondary{background:#eee;color:#111}

    .footer-note{font-size:13px;color:var(--muted);margin-top:16px}

    /* modal */
    .modal-backdrop{position:fixed;inset:0;background:rgba(2,6,23,0.6);display:none;align-items:center;justify-content:center;padding:20px}
    .modal{width:100%;max-width:720px;background:var(--card);border-radius:12px;padding:20px;box-shadow:0 12px 30px rgba(10,20,40,0.3);max-height:80vh;overflow-y:auto;}
    .modal h3{margin-top:0}
    .flex{display:flex;gap:12px}
    .field{margin-bottom:12px}
    label{display:block;font-weight:600;margin-bottom:6px}
    input[type=text], input[type=email], textarea, input[type=tel]{width:100%;padding:10px;border-radius:8px;border:1px solid #e6e9ef}
    textarea{min-height:120px}

    .consent-box{border:1px solid #e6e9ef;border-radius:8px;padding:0;overflow:hidden}
    .consent-scroll{max-height:120px;overflow:auto;padding:12px;background:#fafbfd;border-bottom:1px solid #e6e9ef}
    .consent-actions{padding:12px;display:flex;align-items:center;gap:12px}

    .row{display:flex;gap:12px}
    .col{flex:1}
    .small{font-size:13px;color:var(--muted)}

    .hidden{display:none}

    .note-success{color:green;font-weight:600}

    .code-box{display:inline-block;padding:8px 10px;border-radius:6px;background:#f1f7ff;border:1px solid #d6eaff;font-family:monospace}

    /* responsive */
    @media (max-width:600px){.row{flex-direction:column}}
  </style>
</head>
<body>
  <div class="container">
    <header>
      <div class="logo">감사</div>
      <div>
        <h1>사이버감사실 — 제보 안내</h1>
        <p class="lead">제보유형과 제보절차 안내 및 제보 버튼(임시 시안)</p>
      </div>
    </header>

    <div class="card">
      <h2>제보유형</h2>
      <ul>
        <li><strong>부정·비리 제보</strong> : 횡령, 뇌물, 이익충돌 등</li>
        <li><strong>업무상 비정상적 행위</strong> : 규정 위반, 권한 남용 등</li>
        <li><strong>기타 윤리 위반</strong> : 괴롭힘·성희롱 등</li>
      </ul>

      <h2 style="margin-top:16px">제보절차</h2>
      <ol>
        <li>제보자는 아래 <em>제보하기</em> 버튼을 클릭하여 제보창을 연다.</li>
        <li>개인정보 수집·이용 동의 후 실명/익명 중 선택한다.</li>
        <li>이메일 인증(필수)을 완료한다.</li>
        <li>제보를 제출하면 내부 담당자에게 이메일로 전달된다.</li>
      </ol>

      <div style="margin-top:18px">
        <button id="openBtn" class="btn">제보하기</button>
        <button class="btn secondary" onclick="document.getElementById('preview').scrollIntoView({behavior:'smooth'})"></button>
      </div>

      <p class="footer-note">※ 본 페이지는 디자인 시안입니다. 실제 운영 시에는 서버 측 이메일 전송 및 로그 저장, CSRF·XSS 등 보안 검토가 필요합니다.</p>
    </div>

    <div id="preview" class="card" style="margin-top:20px">
      <h2></h2>
      <p class="small"></p>
    </div>

  </div>

  <!-- Modal -->
  <div id="backdrop" class="modal-backdrop" role="dialog" aria-hidden="true">
    <div class="modal" role="document" aria-labelledby="modalTitle">
      <h3 id="modalTitle">제보하기</h3>
      <div class="field">
        <label>개인정보 수집 및 이용 동의</label>
        <div class="consent-box">
          <div class="consent-scroll" id="consentText">
            <p><strong>수집 항목 :</strong> 이름(실명제보 시), 이메일, 휴대폰 번호(실명제보 시), 제보내용</p>
            <p><strong>수집 및 이용 목적 :</strong> 제보 접수 확인, 추가확인 및 처리결과 통보</p>
            <p><strong>보유기간 :</strong> 관련 법령 및 내부 규정에 따름</p>
            <p>상세한 개인정보 처리방침은 실제 운영 시 별도 페이지에 기재되어야 합니다. (이곳은 모형 텍스트입니다.)</p>
            <p style="margin-top:40px">[스크롤 테스트] 더 많은 동의문 텍스트가 여기에 들어갑니다. 사용자는 스크롤하여 내용을 확인한 뒤 체크박스에 동의해야 합니다.</p>
          </div>
          <div class="consent-actions">
            <input type="checkbox" id="consentCheck">
            <label for="consentCheck" class="small">동의합니다(필수)</label>
            <span class="small" style="margin-left:auto">(스크롤 후 동의 가능)</span>
          </div>
        </div>
      </div>

      <div class="field">
        <label>제보 방식</label>
        <div class="row">
          <label class="col"><input type="radio" name="mode" value="real" checked> 실명 제보</label>
          <label class="col"><input type="radio" name="mode" value="anon"> 익명 제보</label>
        </div>
      </div>

      <form id="reportForm">
        <div id="realFields">
          <div class="field">
            <label>이름</label>
            <input type="text" id="name" placeholder="홍길동">
          </div>
          <div class="field">
            <label>휴대폰 번호</label>
            <input type="tel" id="phone" placeholder="010-1234-5678">
          </div>
        </div>

        <div class="field">
          <label>이메일 (인증 필수)</label>
          <div style="display:flex;gap:8px;align-items:flex-start">
            <input type="email" id="email" placeholder="example@company.co.kr">
            <button type="button" id="sendCodeBtn" class="btn secondary">인증코드 전송</button>
          </div>
          <div id="verificationRow" class="hidden" style="margin-top:8px;display:flex;gap:8px;align-items:center">
            <input type="text" id="emailCode" placeholder="인증번호 입력">
            <button type="button" id="verifyBtn" class="btn">확인</button>
            <span id="verifyStatus" class="small"></span>
          </div>
        </div>

        <div class="field">
          <label>제보 유형 선택 *</label>
          <div class="row">
            <label class="col"><input type="radio" name="type" value="법령위반"> 법령 및 사규 위반 행위</label>
            <label class="col"><input type="radio" name="type" value="청탁비리"> 청탁, 배임, 뇌물, 부정 청탁, 리베이트 등 비위 행위</label>
          </div>
          <div class="row" style="margin-top:8px">
            <label class="col"><input type="radio" name="type" value="회계부정"> 회계부정, 허위보고, 내부통제 위반</label>
            <label class="col"><input type="radio" name="type" value="인권차별"> 인권침해, 직장 내 괴롭힘, 차별 행위</label>
          </div>
          <div class="row" style="margin-top:8px">
            <label class="col"><input type="radio" name="type" value="환경안전"> 환경·안전 관련 법규 위반</label>
            <label class="col"><input type="radio" name="type" value="윤리위반"> 기타 회사의 윤리강령 위배 행위</label>
          </div>
          <div class="row" style="margin-top:8px">
            <label class="col"><input type="radio" name="type" value="업무부정"> 기타 업무적 고충</label>
          </div>
        </div>

        <div class="field">
          <label>언제 *</label>
          <input type="text" id="when" placeholder="ex. 2025년 12월 1일, 12월 중순, 2주일 전쯤 등">
        </div>

        <div class="field">
          <label>어디서 *</label>
          <input type="text" id="where" placeholder="ex. 탕비실, 회의실, 작업룸 등">
        </div>

        <div class="field">
          <label>인지 경로 *</label>
          <div class="row">
            <label class="col"><input type="radio" name="recognition" value="직접경험"> 내게 일어난 일이라서</label>
            <label class="col"><input type="radio" name="recognition" value="직접목격"> 내가 직접 보거나 들은 일이라서</label>
          </div>
          <div class="row" style="margin-top:8px">
            <label class="col"><input type="radio" name="recognition" value="동료전달"> 직장 동료에게 들었음</label>
            <label class="col"><input type="radio" name="recognition" value="외부전달"> 외부인에게 들었음</label>
          </div>
          <div class="row" style="margin-top:8px">
            <label class="col"><input type="radio" name="recognition" value="소문"> 소문으로 들었음</label>
            <label class="col"><input type="radio" name="recognition" value="기타"> 기타</label>
          </div>
        </div>

        <div class="field">
          <label>문제의 지속 기간 *</label>
          <div class="row">
            <label class="col"><input type="radio" name="duration" value="once"> 한번</label>
            <label class="col"><input type="radio" name="duration" value="week"> 일주일</label>
          </div>
          <div class="row" style="margin-top:8px">
            <label class="col"><input type="radio" name="duration" value="1-3m"> 1개월 이상 3개월 미만</label>
            <label class="col"><input type="radio" name="duration" value="3-12m"> 3개월 이상 1년 미만</label>
          </div>
          <div class="row" style="margin-top:8px">
            <label class="col"><input type="radio" name="duration" value="1-3y"> 1년 이상 3년 미만</label>
            <label class="col"><input type="radio" name="duration" value="3y+"> 3년 이상</label>
          </div>
        </div>

        <div class="field">
          <label>상세내용 *</label>
          <textarea id="reportText" placeholder="육하원칙에 따라 구체적으로 작성해 주세요."></textarea>
        </div>

        <div style="display:flex;gap:8px;justify-content:flex-end;margin-top:12px">
          <button type="button" class="btn secondary" id="cancelBtn">취소</button>
          <button type="submit" class="btn" id="submitBtn">제보하기</button>
        </div>
      </form>

      <p id="formNote" class="small" style="margin-top:8px">제출 후 제보 내용은 내부 담당자 이메일로 전달됩니다.</p>

      <div id="result" class="hidden" style="margin-top:12px;border-top:1px dashed #e6e9ef;padding-top:12px">
        <p class="note-success">제보가 성공적으로 제출되었습니다.</p>
        <p class="small">관리자에게 전달된 이메일 예시:</p>
        <pre class="code-box" id="emailPreview">(전달될 이메일 미리보기)</pre>
      </div>
    </div>
  </div>

  <script>
    // UI 동작
    const openBtn = document.getElementById('openBtn');
    const backdrop = document.getElementById('backdrop');
    const cancelBtn = document.getElementById('cancelBtn');
    const consentCheck = document.getElementById('consentCheck');

    openBtn.addEventListener('click', ()=>{ backdrop.style.display='flex'; backdrop.setAttribute('aria-hidden','false'); });
    cancelBtn.addEventListener('click', closeModal);
    backdrop.addEventListener('click', (e)=>{ if(e.target===backdrop) closeModal(); });

    function closeModal(){ backdrop.style.display='none'; backdrop.setAttribute('aria-hidden','true'); resetForm(); }

    // mode 선택에 따른 필드 토글
    const modeRadios = document.querySelectorAll('input[name="mode"]');
    const realFields = document.getElementById('realFields');
    modeRadios.forEach(r=>r.addEventListener('change', updateMode));
    function updateMode(){ const v = document.querySelector('input[name="mode"]:checked').value; realFields.style.display = (v==='real')? 'block' : 'none'; }
    updateMode();

    // 이메일 인증 시뮬레이션 (프론트엔드 프로토타입)
    let currentCode = null; let verified = false; let codeTimer = null;
    const sendCodeBtn = document.getElementById('sendCodeBtn');
    const verificationRow = document.getElementById('verificationRow');
    const verifyBtn = document.getElementById('verifyBtn');
    const verifyStatus = document.getElementById('verifyStatus');

    sendCodeBtn.addEventListener('click', ()=>{
      const email = document.getElementById('email').value.trim();
      if(!email){ alert('이메일을 입력하세요.'); return; }
      if(!consentCheck.checked){ alert('개인정보 수집 및 이용에 동의해야 합니다.'); return; }
      // 실제 서비스에서는 서버에 요청을 보내 인증코드를 발송해야 합니다.
      // 아래는 디자인 시안용 클라이언트 시뮬레이션입니다.
      currentCode = Math.floor(100000 + Math.random()*900000).toString();
      verificationRow.classList.remove('hidden');
      verifyStatus.textContent = '전송된 인증코드: ' + currentCode + ' (시안용)';
      verified = false; document.getElementById('emailCode').value='';
      // 타이머로 코드 만료 시킬 수 있음(시안에서는 생략)
    });

    verifyBtn.addEventListener('click', ()=>{
      const entered = document.getElementById('emailCode').value.trim();
      if(!currentCode){ alert('먼저 인증코드를 전송하세요.'); return; }
      if(entered===currentCode){ verified=true; verifyStatus.textContent='인증 완료'; verifyStatus.style.color='green'; }
      else { verified=false; verifyStatus.textContent='인증 실패'; verifyStatus.style.color='red'; }
    });

    // 제출 처리 (시안): 실제 이메일 전송은 서버 필요. 아래는 전송할 페이로드 예시를 보여줌.
    const form = document.getElementById('reportForm');
    form.addEventListener('submit', (e)=>{
      e.preventDefault();
      // 유효성 검사
      if(!consentCheck.checked){ alert('개인정보 수집 및 이용에 동의해주세요.'); return; }
      const mode = document.querySelector('input[name="mode"]:checked').value;
      const email = document.getElementById('email').value.trim();
      if(!email){ alert('이메일을 입력하세요.'); return; }
      if(!verified){ alert('이메일 인증을 완료해야 합니다.'); return; }
      const reportText = document.getElementById('reportText').value.trim();
      if(!reportText){ alert('제보 내용을 입력하세요.'); return; }

      const payload = {
        mode: mode,
        name: (mode==='real')? document.getElementById('name').value.trim() : null,
        phone: (mode==='real')? document.getElementById('phone').value.trim() : null,
        email: email,
        text: reportText,
        timestamp: new Date().toISOString()
      };

      // 실제 운영: 아래 fetch를 활성화하여 서버에 POST하면 서버가 이메일을 전송하도록 구현한다.
      /*
      fetch('/submit-report', {
        method: 'POST', headers:{'Content-Type':'application/json'}, body: JSON.stringify(payload)
      }).then(r=>r.json()).then(res=>{ // 서버 처리 결과에 따라 성공/실패 처리 });
      */

      // 시안 동작: 이메일 미리보기에 페이로드 표기
      document.getElementById('emailPreview').textContent = JSON.stringify({
        to: '담당자@company.co.kr',
        subject: '[제보] 사이버감사실 접수',
        body: payload
      }, null, 2);

      document.getElementById('result').classList.remove('hidden');
      // 폼 비활성화
      document.getElementById('submitBtn').disabled = true;
    });

    function resetForm(){ document.getElementById('reportForm').reset(); consentCheck.checked=false; verificationRow.classList.add('hidden'); verifyStatus.textContent=''; currentCode=null; verified=false; document.getElementById('result').classList.add('hidden'); document.getElementById('submitBtn').disabled=false; updateMode(); }
  </script>
</body>
</html>
